# ------------------------------------------------------------------------
# NAFNet Evaluation Config with Learnable Compression Matrix A
# ------------------------------------------------------------------------

name: LearnableCS_Eval
model_type: ImageRestorationModel
scale: 1
num_gpu: 1
manual_seed: 42
dist: false

datasets:
  test:
    name: custom-test
    type: UncompressedNpyDataset
    target_dir: DUMMY_TO_BE_REPLACED   # Will be set by --input_dir
    upsample_type: pinv
    normalize: true
    noise_std: 0.0
    reshape_to_image: true
    num_worker_per_gpu: 1
    batch_size_per_gpu: 1
    use_shuffle: false
    phase: test

network_g:
  type: NAFNet
  img_channel: 1
  width: 32
  enc_blk_nums: [1, 1, 1, 28]
  middle_blk_num: 1
  dec_blk_nums: [1, 1, 1, 1]
  # For the learnable compression matrix A
  num_input_channels: 128       # Must match training
  compression_ratio: 8          # Must match training

path:
  root: /home/vk38/E2E-Photoacoustic-CS/
  experiments_root: /home/vk38/E2E-Photoacoustic-CS/experiments
  results_root: /home/vk38/E2E-Photoacoustic-CS/results
  pretrain_network_g: ~   # Will be overwritten by --ckpt argument
  strict_load_g: true

val:
  save_img: true
  use_image: false
  rgb2bgr: false  # Grayscale
  metrics:
    mse:
      type: calculate_mse
      crop_border: 0
      test_y_channel: false

dist_params:
  backend: nccl
  port: 2950