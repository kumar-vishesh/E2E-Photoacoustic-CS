# ----------------------------------------------------------------
# Custom NAFNet Config for On-the-Fly Compressed Synthetic Dataset
# ----------------------------------------------------------------

name: NAFNet-Synthetic-OnTheFly_Test
model_type: ImageRestorationModel
scale: 1
num_gpu: 1
manual_seed: 42

datasets:
  test:
    name: synthetic-val
    type: CompressedNpyDataset
    target_dir: /home/vk38/Photoacoustics/SyntheticData/Dataset/val
    upsample_type: pinv  # or 'bicubic'
    normalize: true
    noise_std: 0.01
    reshape_to_image: true
    # compression_factor: 4  # Only needed if using 'bicubic'
    A_path: DUMMY_TO_BE_REPLACED
    num_worker_per_gpu: 1
    batch_size_per_gpu: 1   # Important for consistent MSE eval
    use_shuffle: false
    phase: test
    save_debug_data: false
    debug_save_dir: ./debug_pairs/val
    debug_max_to_save: 50

  train_test:
    name: synthetic-train
    type: CompressedNpyDataset
    target_dir: /home/vk38/Photoacoustics/SyntheticData/Dataset/train
    upsample_type: pinv
    normalize: true
    noise_std: 0.01
    reshape_to_image: true
    # compression_factor: 4
    A_path: DUMMY_TO_BE_REPLACED
    num_worker_per_gpu: 1
    batch_size_per_gpu: 1
    use_shuffle: false
    phase: test
    save_debug_data: false
    debug_save_dir: ./debug_pairs/train
    debug_max_to_save: 100

network_g:
  type: NAFNet
  img_channel: 1
  width: 32
  enc_blk_nums: [1, 1, 1, 28]
  middle_blk_num: 1
  dec_blk_nums: [1, 1, 1, 1]

path:
  root: /home/vk38/Photoacoustics/NAFNet_Experiments
  experiments_root: /home/vk38/Photoacoustics/NAFNet_Experiments/experiments
  results_root: /home/vk38/Photoacoustics/NAFNet_Experiments/results
  pretrain_network_g: ~  # this will be overwritten in multi_eval.py per checkpoint
  strict_load_g: true

val:
  use_image: false
  save_img: false
  metrics:
    mse:
      type: calculate_mse
      crop_border: 0
      test_y_channel: false

dist_params:
  backend: nccl
  port: 2950
